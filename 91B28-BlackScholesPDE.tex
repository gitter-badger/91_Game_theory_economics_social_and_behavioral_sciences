\documentclass[12pt]{article}
\usepackage{pmmeta}
\pmcanonicalname{BlackScholesPDE}
\pmcreated{2013-03-22 16:31:08}
\pmmodified{2013-03-22 16:31:08}
\pmowner{stevecheng}{10074}
\pmmodifier{stevecheng}{10074}
\pmtitle{Black-Scholes PDE}
\pmrecord{6}{38697}
\pmprivacy{1}
\pmauthor{stevecheng}{10074}
\pmtype{Result}
\pmcomment{trigger rebuild}
\pmclassification{msc}{91B28}
\pmclassification{msc}{60H10}
\pmsynonym{Black-Scholes partial differential equation}{BlackScholesPDE}
\pmsynonym{Black-Scholes equation}{BlackScholesPDE}
\pmrelated{AnalyticSolutionOfBlackScholesPDE}
\pmrelated{ExampleOfSolvingTheHeatEquation}

\endmetadata

% The standard font packages
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}

% For neatly defining theorems and definitions
%\usepackage{amsthm}

% Including EPS/PDF graphics (\includegraphics)
%\usepackage{graphicx}

% Making matrix-based graphics
%%%\usepackage{xypic}

% Enumeration lists with different styles
%\usepackage{enumerate}

% Set up the theorem environments
%\newtheorem{thm}{Theorem}
%\newtheorem*{thm*}{Theorem}

\providecommand{\defnterm}[1]{\emph{#1}}

% The standard number systems
\newcommand{\complex}{\mathbb{C}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\rat}{\mathbb{Q}}
\newcommand{\nat}{\mathbb{N}}
\newcommand{\intset}{\mathbb{Z}}

% Absolute values and norms
% Normal, wide, and big versions of the delimeters
\providecommand{\abs}[1]{\lvert#1\rvert}
\providecommand{\absW}[1]{\left\lvert#1\right\rvert}
\providecommand{\absB}[1]{\Bigl\lvert#1\Bigr\rvert}
\providecommand{\norm}[1]{\lVert#1\rVert}
\providecommand{\normW}[1]{\left\lVert#1\right\rVert}
\providecommand{\normB}[1]{\Bigl\lVert#1\Bigr\rVert}

% Differentiation operators
\providecommand{\od}[2]{\frac{d #1}{d #2}}
\providecommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
\providecommand{\pdd}[2]{\frac{\partial^2 #1}{\partial #2}}
\providecommand{\ipd}[2]{\partial #1 / \partial #2}

% Differentials on integrals
\newcommand{\dx}{\, dx}
\newcommand{\dt}{\, dt}
\newcommand{\dmu}{\, d\mu}

% Inner products
\providecommand{\ip}[2]{\langle {#1}, {#2} \rangle}

% Calligraphic letters
\newcommand{\sF}{\mathcal{F}}
\newcommand{\sD}{\mathcal{D}}
\newcommand{\Hilb}{\mathcal{H}}
\newcommand{\Le}{\mathbf{L}}

% Operators and functions occassionally used in my articles
\DeclareMathOperator{\D}{D}
\DeclareMathOperator{\linspan}{span}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\lindim}{dim}
\DeclareMathOperator{\sinc}{sinc}

\newcommand{\E}{\mathbb{E}}
\newcommand{\EQ}{\mathbb{E}^\mathbb{Q}}
\newcommand{\PQ}{\mathbb{Q}}

\begin{document}
\PMlinkescapeword{term}
\PMlinkescapeword{representation}
\PMlinkescapeword{terminal}
\PMlinkescapeword{current}
\PMlinkescapeword{regularity}
\PMlinkescapeword{arguments}
\PMlinkescapeword{even}
\PMlinkescapeword{amenable}
\PMlinkescapeword{computable}
\PMlinkescapeword{length}
\PMlinkescapeword{transformation}

\tableofcontents

\medskip

The \defnterm{Black-Scholes partial differential equation}
is the partial differentiation equation:
\begin{align}\label{eq:pde}
rf = \pd{f}{t} + rx \, \pd{f}{x} + \frac12 \sigma^2 x^2 \, \pdd{f}{x^2}\,,
\quad f = f(t,x)\,, 
\end{align}
on the domain $0 \leq x < \infty\,, \: 0 \leq t \leq T$.
Its solution gives the price function
of a stock option (or any other contingent claim on a tradable asset)
under the assumptions of the Black-Scholes model for prices.

The parameters $r$, $\sigma > 0$ and $T > 0$
are, respectively, the prevailing continuously-compounded risk-free
rate of interest, the volatility of the stock,
and the time to maturity of the stock option.

More generally, the term \defnterm{Black-Scholes partial differential equation}
can refer to other partial differential equations
similar in form to equation \eqref{eq:pde}, derived 
in similar ways under more
general modelling assumptions than the most basic Black-Scholes model.


\subsection{Derivation from martingale form}

The \emph{Black-Scholes formula}, in its martingale form,
gives the theoretical value of the stock option
\begin{align}\label{eq:martingale}
V(t) = e^{-r(T-t)} \, \EQ[V(T) \mid \sF_t]\,, \quad 0 \leq t \leq T\,,
\end{align}
where $V(T)$ is a given pay-off function
or terminal condition, assumed to be a $\Le^1(\PQ)$ random variable;
$\sF_t$ is the filtration generated by the the standard Wiener
process $\widetilde{W}(t)$
under the probability measure $\PQ$ (the ``risk-neutral measure'').

Equation \eqref{eq:martingale} 
gives the solution to the stochastic differential equations:
\begin{align}
V(t) &= \Delta(t) X(t) + \Theta(t) M(t)\,, \quad M(t) = e^{rt}\,, 
\label{eq:port}
\\
dV(t) &= \Delta(t) \, dX(t) + \Theta(t) \, dM(t)\,, \quad dM(t) = r M(t) \, dt\,, 
\label{eq:port-sde}
\\
dX(t) &= r X(t) \, dt + \sigma X(t) \, d\widetilde{W}(t)
\,. \label{eq:stock-sde}
\end{align}

From the martingale form of the result,
there are two ways to derive the PDE form \eqref{eq:pde}.

\subsubsection{Using the Feynman-Kac formula}

One way is to appeal to the Feynman-Kac formula,
which states in this case, that
under certain regularity conditions\footnote{
The standard assumption is that $\psi$ is twice continuously-differentiable
and $\EQ[ \abs{ \psi(X(T)) } ] < \infty$.
However, for the particular PDE we consider, 
these assumptions can be relaxed.}
on the
function $\psi \colon (0, \infty) \to \real$, the 
function $f \colon [0,T] \times (0, \infty) \to \real$ 
defined by
\begin{align}\label{eq:feynman-kac}
f(t, x) = e^{-r(T-t)} \, \EQ[ \, \psi(X(T)) \mid X(t) = x]\,,
\end{align}
satisfies the partial differential equation \eqref{eq:pde}
with the terminal condition
\[
f(T, x) = \psi(x)\,.
\]
(The stochastic process $X(t)$
is to satisfy equation \eqref{eq:stock-sde}.)

Now, equations \eqref{eq:feynman-kac} and \eqref{eq:martingale}
look quite similar,
but with an important difference:
the conditional expectation on equation \eqref{eq:feynman-kac}
is with respect to the event $\{ X(t) = x\}$,
while equation \eqref{eq:martingale}
is conditioning on the filtration $\sF_t$.
We claim that these are actually the same thing ---
that is, for fixed $t$, the random variable
$\EQ[V(T) \mid \sF_t]$
can be written as a function of $X(t)$ ---
\emph{provided that the terminal condition is itself a function of $X(T)$}:
%\begin{align}\label{eq:func-assumption}
\[
V(T) = \psi(X(T))\,.
\]
%\end{align}

We will demonstrate this claim later.  Assuming that the claim holds,
we may thus set $V(t) = f(t, X(t))$,
and the Black-Scholes partial differential equation follows from
the Feynman-Kac formula as explained earlier.

\subsubsection{Proof of Markov property}

Formally, any $\sF_t$-measurable stochastic process
$X(t)$ that 
ensures $\E[ \psi(X(T)) \mid \sF_t]$
is always a measurable function of $X(t)$,
for any Borel-measurable $\psi$,
is called a \emph{Markov process},
or is said to have the \emph{Markov property}.
Thus we want to show that the stock process $X(t)$ has
the Markov property.
For this,  
we will need the following explicit
solution for it at time $T$
in terms of an initial condition at time $t$:
\begin{align*}
X(T) &= X(t) \, \exp\Bigl( (r-\tfrac12 \sigma^2) (T-t) +
\sigma\bigl( \widetilde{W}(T) - \widetilde{W}(t) \bigr) \Bigr) \\
&:= 
 X(t) \, g \bigl( \widetilde{W}(T) - \widetilde{W}(t) \bigr)\,.
\end{align*}
Then
\begin{align*}
\EQ[V(T) \mid \sF_t] &= \EQ[\psi(X(T)) \mid \sF_t] = \EQ\left[ \psi\bigl( X(t) \, g( \widetilde{W}(T) - \widetilde{W}(t) ) \bigr) \mid \sF_t\right]\,.
\end{align*}
Since $X(t)$ is $\sF_t$-measurable,
it may be treated as a constant $x$ while taking conditional
expectations with respect to $\sF_t$.
And $\widetilde{W}(T) - \widetilde{W}(t)$
is a random variable independent of $\sF_t$ (and hence of $X(t)$).
Therefore the expression that appears on the right-hand side
above is a function of $x = X(t)$,
and would be unchanged if the conditioning
is changed from $\sF_t$ to $X(t)$.

\subsubsection{Using It\=o's formula}

There is also a more direct method
of deriving equation \eqref{eq:pde}
using It\=o's formula for It\=o processes.

Set $V(t) = f(t, X(t))$
as before.
Make the assumption that $f$ is twice continuously differentiable,
to be checked later; then we can apply It\=o's formula to expand $dV(t)$:
(partial derivatives evaluated at $x = X(t)$)
\begin{equation}\label{eq:ito}
\begin{split}
dV(t) &= \pd{f}{t} \, dt + \pd{f}{x} \, dX(t) + \frac12 \pdd{f}{x^2}
\,
dX(t) dX(t) \\
&=
\Bigl( \pd{f}{t} + \frac12 \sigma^2 X(t)^2 \, \pdd{f}{x^2} \Bigr) \, dt
+ \pd{f}{x} \, dX(t)\,.
\end{split}
\end{equation}
By theorems on the uniqueness of solutions to stochastic differential
equations, the coefficients of the 
correponding $dt$ and $dX(t)$
terms in equations \eqref{eq:port-sde} and \eqref{eq:ito}
must be equal almost surely.
Equating the coefficients, we find:
\begin{align}
\Delta(t) &= \pd{f}{x}\,, \label{eq:delta} \\
r \bigl( V(t) - \Delta(t) X(t) \bigr) &= \Theta(t) r M(t) = 
\pd{f}{t} + \frac12 \sigma^2 X(t)^2 \, \pdd{f}{x^2} \label{eq:theta}\,.
\end{align}

Equation \eqref{eq:theta}
is essentially equation \eqref{eq:pde},
except that $x$ has been replaced by $X(t)$ in some places.
However,
because $X(t)$ is a random variable that takes on all values on $(0, \infty)$,
and $f$ and its derivatives are assumed to be continuous,
equation \eqref{eq:theta} must hold for arbitrary values $x$
substituted for $X(t)$.  Hence we obtain equation \eqref{eq:pde}.

To verify 
the initial assumption that $f$ is twice continuously differentiable,
we write formula \eqref{eq:martingale}
in a more explicit form (using the Markov property for $X(t)$ as before):
\begin{align*}
f(t,x) &= e^{-r(T-t)} \, \EQ[\psi(X(T)) \mid X_t = x] \\
&= \int_{-\infty}^\infty e^{-r(T-t)} \psi(y) \, p(x, y, T-t) \, dy\,,
\end{align*}
where $p(x,y,\tau)$ is the transition density of the 
stock process from $x$ to $y$ over a time interval of length $\tau$.
In fact, from the solution for $X(t)$,
the density $p(x, \cdot, \tau)$
is the density for the log-normal random variable
whose logarithm has mean $\log x + (r-\tfrac12 \sigma^2)\tau$
and variance $\sigma^2 \tau$.
By differentiation under the integral sign,
we see that $f(t,x)$ must be twice continously differentiable
for $0 \leq t < T$ and $0 < x < \infty$.

\subsection{Comparison of the martingale and PDE forms}

The martingale formulation of the result,
\PMlinkescapetext{contained} in equation \eqref{eq:martingale}
is more general than the PDE formulation \eqref{eq:pde}:
the latter imposes extra regularity conditions,
and more importantly,
it can only describe prices $V(t) = f(t,X(t))$
that are
\emph{functions only of the time $t$ and the current stock price $X(t)$}.
In the case of the call option ($\psi(x) = x- K$ for some $K > 0$),
this \PMlinkescapetext{functional} assumption is true;
but there are other sorts of contingent claims
whose pay-off depend on the history of the stock process $X(t)$ ---
for example, a common kind of contingent claim has a final
pay-off that depends on an average
of the stock price $X(t)$ over time $t \in [0,T]$.

However, the PDE form of the solution is often more
amenable to a numerical solution.
While the expectation in equation \eqref{eq:martingale}
can be approximated numerically
with Monte-Carlo simulation,
for low-dimensional problems,
solutions based on finite-difference approximations
of PDEs are often quicker to compute than those based on Monte-Carlo.

\subsection{Analytic solution}

Though the solution for the Black-Scholes PDE
is already known using the martingale representation \eqref{eq:martingale},
we can also \PMlinkname{solve the PDE directly using classical analytical methods}{AnalyticSolutionOfBlackScholesPDE}.

Actually, the classical solution can be quite instructive
in that it shows more or less the physical meaning
behind the PDE, and also the behavior of solutions
as the terminal condition is varied.  (For example,
the PDE is a transformation of a diffusion equation,
and consequently its solutions are always infinitely smooth,
as long as the terminal condition satisfies 
some local-integrability properties.)

\subsection{Quantity of stock needed to replicate option}

Another important result that 
must not be left unmentioned is
equation \eqref{eq:delta}, derived during
the course of showing the Black-Scholes PDE.

In the article on the Black-Scholes pricing formula,
a solution for $V(t)$ was produced
that satisfied \eqref{eq:port-sde},
but the $\sF_t$-adapted process $\delta(t)$
that appears in that stochastic differential equation was 
obtained by appealing to an existence theorem.
However, under the assumption that $V(t) = f(t,X(t))$,
equation \eqref{eq:delta} gives an actual computable formula:
\[
\Delta(t) = \left.\pd{f(t,x)}{x} \right|_{x = X(t)}\,.
\]
which is crucial in practice, 
for the theoretical ``price''
of a stock option 
would be useless if one cannot produce in reality that option
for the stated price.

\subsection{Generalizations}

(To be written.)

%%%%%
%%%%%
\end{document}
